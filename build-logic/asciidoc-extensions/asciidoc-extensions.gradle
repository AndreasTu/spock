plugins {
  id 'java-library'
  id 'idea'
}

dependencies {
  // sync with version from https://github.com/asciidoctor/asciidoctor-gradle-plugin/blob/master/jvm/build.gradle ?
  compileOnly 'org.asciidoctor:asciidoctorj:2.5.11'
}

java {
  toolchain {
    // IntelliJ currently doesn't support running classes compiled with Java 21 in its preview viewer
    languageVersion = JavaLanguageVersion.of(17)
  }
}

tasks.register('installAsciidocExtension', Copy) {
  from(tasks.named('jar'))
  into('../../.asciidoctor/lib')
}

tasks.named('ideaModule') {
  it.dependsOn('installAsciidocExtension')
}
